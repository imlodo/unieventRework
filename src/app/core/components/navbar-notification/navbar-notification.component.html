<div class="navbar-nav">
    <div class="nav-item text-nowrap">
        <a matTooltip="Notifiche" class="nav-link px-1 link-icon-text no-padding pointer"
            (click)="openNotificationModal()"><i class="gg-bell pointer"></i>
            <span [ngClass]="notificationCount <= 99 ? '': 'bell-info-full'" class="bell-info">{{notificationCount > 99
                ? '99+' : notificationCount}}</span>
        </a>
    </div>
</div>
<div [ngClass]="darkMode ? 'notification-dark-mode text-white' : 'notification-light-mode text-black' "  *ngIf="showNotifications" class="position-absolute border-0 p-3 notification shadow">
    <div class="d-flex flex-column">
        <div class="d-flex flex-row justify-content-between mb-3" style="align-items: center;">
            <h1 class="m-0"><b>Notifiche</b></h1>
            <div class="more-div pointer" (click)="openNotificationSettingModal()"><i class="gg-more mr-3"></i></div>
        </div>
        <div *ngIf="notificationAllArray.length > 0" class="d-flex flex-row justify-content-start mb-3"
            style="align-items: center;">
            <h3 (click)="changeNotificationMode(0)"
                [ngClass]="activeNotification[0] ? 'activeNotification' : 'notActiveNotification' "
                class="m-0 notificationAll pointer">Tutte</h3>
            <h3 (click)="changeNotificationMode(1)"
                [ngClass]="activeNotification[1] ? 'activeNotification' : 'notActiveNotification' "
                class="m-0 mx-3 notificationNotRead pointer">Non lette</h3>
        </div>
        <div *ngIf="notificationAllArray.length > 0 && (activeNotification[0] || (activeNotification[1] && countNotRead > 0))" class="d-flex flex-row justify-content-between mb-3"
            style="align-items: center;">
            <h2 class="m-0">Recenti</h2>
            <h3 class="m-0 notificationShowAll pointer" (click)="goToAllNotification()">Mostra tutte</h3>
        </div>
        <div *ngIf="notificationAllArray.length > 0" class="d-flex flex-column">
            <ng-container *ngFor="let notificationEl of notificationAllArray">
                <div [ngClass]="(notificationEl.type != NOTIFICATION_TYPE_CP.FRIEND_REQUEST_ACCEPTED) && (notificationEl.type != NOTIFICATION_TYPE_CP.FRIEND_REQUEST_REFUSED) && notificationEl.not_read ? 'not-read' : ''"
                    *ngIf="activeNotification[0] || (activeNotification[1] && notificationEl.not_read && countNotRead > 0)"
                    class="d-flex flex-row mb-3 notificationElement p-2 pointer">
                    <img *ngIf="(notificationEl.type != NOTIFICATION_TYPE_CP.FRIEND_REQUEST_ACCEPTED) && (notificationEl.type != NOTIFICATION_TYPE_CP.FRIEND_REQUEST_REFUSED)"
                        class="notificationImage" [attr.src]="notificationEl.image" width="70" height="70"
                        style="border-radius: 100px;" />
                    <div class="d-flex flex-column justify-content-center mx-2">
                        <div class="d-flex flex-column justify-content-center">
                            <span class="notificazionTitle">{{notificationEl.body}}</span>
                            <span class="notificationHour">{{getHourStr(notificationEl.creationDateTime)}}</span>
                        </div>
                        <div *ngIf="notificationEl.type == NOTIFICATION_TYPE_CP.FRIEND_REQUEST"
                            class="d-flex flex-row mt-2">
                            <button (click)="actionFriendRequest(true,notificationEl.notification_id)"
                                class="col-6 btn btn-primary text-white btn-rem-09">Accetta</button>
                            <button (click)="actionFriendRequest(false,notificationEl.notification_id)"
                                class="col-6 btn btn-secondary mx-2 btn-rem-09">Rifiuta</button>
                        </div>
                    </div>
                </div>
            </ng-container>
            <div *ngIf="!activeNotification[0] && (activeNotification[1] && countNotRead <= 0)" class="my-4 d-flex flex-column justify-content-center align-items-center pointer">
                <svg xmlns="http://www.w3.org/2000/svg" width="120" height="120" fill="currentColor" class="bi bi-bell"
                    viewBox="0 0 16 16">
                    <path
                        d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2M8 1.918l-.797.161A4 4 0 0 0 4 6c0 .628-.134 2.197-.459 3.742-.16.767-.376 1.566-.663 2.258h10.244c-.287-.692-.502-1.49-.663-2.258C12.134 8.197 12 6.628 12 6a4 4 0 0 0-3.203-3.92zM14.22 12c.223.447.481.801.78 1H1c.299-.199.557-.553.78-1C2.68 10.2 3 6.88 3 6c0-2.42 1.72-4.44 4.005-4.901a1 1 0 1 1 1.99 0A5 5 0 0 1 13 6c0 .88.32 4.2 1.22 6" />
                </svg>
                <h3 class="my-2">Non ci sono nuove notifiche da leggere</h3>
            </div>
        </div>
        <div *ngIf="notificationAllArray.length <= 0" class="my-4 d-flex flex-column justify-content-center align-items-center pointer">
            <svg xmlns="http://www.w3.org/2000/svg" width="120" height="120" fill="currentColor" class="bi bi-bell"
                viewBox="0 0 16 16">
                <path
                    d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2M8 1.918l-.797.161A4 4 0 0 0 4 6c0 .628-.134 2.197-.459 3.742-.16.767-.376 1.566-.663 2.258h10.244c-.287-.692-.502-1.49-.663-2.258C12.134 8.197 12 6.628 12 6a4 4 0 0 0-3.203-3.92zM14.22 12c.223.447.481.801.78 1H1c.299-.199.557-.553.78-1C2.68 10.2 3 6.88 3 6c0-2.42 1.72-4.44 4.005-4.901a1 1 0 1 1 1.99 0A5 5 0 0 1 13 6c0 .88.32 4.2 1.22 6" />
            </svg>
            <h3 class="my-2">Non ci sono nuove notifiche da leggere</h3>
        </div>
    </div>
    <unievent-notification-setting [darkMode]="darkMode" (setAllNotificationRead)="setAllNotificationRead()"
        (closeNotificationPanel)="closeNotifications()" (closeNotificationSetting)="closeNotificationSetting()"
        *ngIf="showNotificationSetting"></unievent-notification-setting>
</div>